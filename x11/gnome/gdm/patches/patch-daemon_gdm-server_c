$OpenBSD: patch-daemon_gdm-server_c,v 1.2 2014/03/29 14:46:26 ajacoutot Exp $

XXX push upstream
(no sigwaitinfo(2) on OpenBSD)

--- daemon/gdm-server.c.orig	Wed Mar 19 16:15:29 2014
+++ daemon/gdm-server.c	Sat Mar 29 15:41:19 2014
@@ -233,8 +233,11 @@ sigusr1_thread_main (gpointer user_data)
         /* Spin waiting for a SIGUSR1 */
         while (TRUE) {
                 siginfo_t info;
+                int ret, sig;
 
-                if (sigwaitinfo (&sigusr1_mask, &info) == -1)
+                ret = sigwait (&sigusr1_mask, &sig);
+                info.si_pid = getpid ();
+                if (ret != 0)
                         continue;
 
                 g_idle_add (got_sigusr1, GUINT_TO_POINTER (info.si_pid));
