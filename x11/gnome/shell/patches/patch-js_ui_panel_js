$OpenBSD: patch-js_ui_panel_js,v 1.5 2013/03/30 08:04:19 jasper Exp $

Make Network Manager support optional.
https://bugzilla.gnome.org/show_bug.cgi?id=679871

--- js/ui/panel.js.orig	Mon Mar 18 16:36:03 2013
+++ js/ui/panel.js	Fri Mar 29 20:39:33 2013
@@ -883,11 +883,13 @@ if (Config.HAVE_BLUETOOTH)
     PANEL_ITEM_IMPLEMENTATIONS['bluetooth'] =
         imports.ui.status.bluetooth.Indicator;
 
-try {
-    PANEL_ITEM_IMPLEMENTATIONS['network'] =
-        imports.ui.status.network.NMApplet;
-} catch(e) {
-    log('NMApplet is not supported. It is possible that your NetworkManager version is too old');
+if (Config.HAVE_NETWORK_MANAGER) {
+    try {
+        PANEL_ITEM_IMPLEMENTATIONS['network'] =
+            imports.ui.status.network.NMApplet;
+    } catch(e) {
+        log('NMApplet is not supported. It is possible that your NetworkManager version is too old');
+    }
 }
 
 const Panel = new Lang.Class({
