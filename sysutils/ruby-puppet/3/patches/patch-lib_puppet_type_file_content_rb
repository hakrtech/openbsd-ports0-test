$OpenBSD: patch-lib_puppet_type_file_content_rb,v 1.1 2013/11/25 15:56:23 ajacoutot Exp $

From 40c67e2cd21c36b34948571c59ebd999c5c4cf21 Mon Sep 17 00:00:00 2001
From: "Dustin J. Mitchell" <dustin@mozilla.com>
Date: Fri, 9 Aug 2013 16:05:40 -0400
Subject: [PATCH 1/2] (#22129) force explicit file content to be treated as a bytestring

--- lib/puppet/type/file/content.rb.orig	Mon Oct  7 20:00:47 2013
+++ lib/puppet/type/file/content.rb	Mon Nov 25 15:52:36 2013
@@ -133,6 +133,9 @@ module Puppet
 
     # Make sure we're also managing the checksum property.
     def should=(value)
+      # treat the value as a bytestring, in Ruby versions that support it, regardless of the encoding
+      # in which it has been supplied
+      value = value.clone.force_encoding(Encoding::ASCII_8BIT) if value.respond_to?(:force_encoding)
       @resource.newattr(:checksum) unless @resource.parameter(:checksum)
       super
     end
