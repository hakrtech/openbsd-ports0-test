$OpenBSD: patch-lib_facter_memory_rb,v 1.9 2014/06/19 13:56:10 jasper Exp $
--- lib/facter/memory.rb.orig	Tue Apr  1 19:23:03 2014
+++ lib/facter/memory.rb	Fri Apr  4 15:34:23 2014
@@ -82,6 +82,16 @@ end
   end
 end
 
+if Facter.value(:kernel) == "OpenBSD"
+  Facter.add("SwapEncrypted") do
+    confine :kernel => :openbsd
+    setcode do
+      encrypted = !Facter::Util::Resolution.exec("/sbin/sysctl -n vm.swapencrypt.enable").to_i.zero?
+      encrypted
+    end
+  end
+end
+
 if Facter.value(:kernel) == "Darwin"
   Facter.add("SwapEncrypted") do
     confine :kernel => :Darwin
