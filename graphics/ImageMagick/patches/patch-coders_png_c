$OpenBSD: patch-coders_png_c,v 1.9 2012/06/12 17:40:35 okan Exp $
--- coders/png.c.orig	Thu May 17 16:47:50 2012
+++ coders/png.c	Sun May 20 20:17:39 2012
@@ -2217,7 +2217,7 @@ static Image *ReadOnePNGImage(MngInfo *mng_info,
 
 #if (PNG_LIBPNG_VER < 10400)
 #  if defined(PNG_USE_PNGGCCRD) && defined(PNG_ASSEMBLER_CODE_SUPPORTED) && \
-   (PNG_LIBPNG_VER >= 10200) && (PNG_LIBPNG_VER < 10220) && defined(__i386__)
+   (PNG_LIBPNG_VER >= 10200) && (PNG_LIBPNG_VER < 10220) && defined(PNG_MMX_CODE_SUPPORTED)
   /* Disable thread-unsafe features of pnggccrd */
   if (png_access_version_number() >= 10200)
   {
