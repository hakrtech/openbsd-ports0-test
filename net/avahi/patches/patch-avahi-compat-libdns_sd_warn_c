$OpenBSD: patch-avahi-compat-libdns_sd_warn_c,v 1.4 2013/05/23 13:40:38 ajacoutot Exp $

Stop polluting syslog(3).

--- avahi-compat-libdns_sd/warn.c.orig	Thu Aug 26 02:51:38 2010
+++ avahi-compat-libdns_sd/warn.c	Thu May 23 15:27:58 2013
@@ -75,6 +75,9 @@ const char *avahi_exe_name(void) {
     pthread_mutex_unlock(&mutex);
 
     return exe_name;
+#elif defined(__OpenBSD__)
+    extern const char* __progname;
+    return __progname;
 #else
 #ifdef __GNUC__
 #warning "avahi_exe_name() needs to be implemented for your operating system"
@@ -110,11 +113,13 @@ void avahi_warn_linkage(void) {
     linkage_warning = 1;
     pthread_mutex_unlock(&linkage_mutex);
 
+#if 0
     if (!w && !getenv("AVAHI_COMPAT_NOWARN")) {
         avahi_warn("The program '%s' uses the "COMPAT_LAYER" compatibility layer of Avahi.", avahi_exe_name());
         avahi_warn("Please fix your application to use the native API of Avahi!");
         avahi_warn("For more information see <http://0pointer.de/avahi-compat?s="CGI_SUBSYSTEM"&e=%s>", avahi_exe_name());
     }
+#endif
 }
 
 void avahi_warn_unsupported(const char *function) {
