$OpenBSD: patch-main_c,v 1.2 2013/12/07 22:37:14 jca Exp $
--- main.c.orig	Sun Aug 28 16:12:06 1994
+++ main.c	Fri Dec  6 15:10:34 2013
@@ -100,8 +100,12 @@ int write();
 extern void term_echo();
 
 int last_line_length;
-#if defined(HAVE_SYS_TERMIO_H) && !defined(BSD_ECHO)
+#if defined(HAVE_TERMIOS_H) || (defined(HAVE_SYS_TERMIO_H) && !defined(BSD_ECHO))
+#ifdef HAVE_TERMIOS_H
+#include <termios.h>
+#else
 #include <sys/termio.h>
+#endif
 #ifdef HAVE_TCFLAG_T
 tcflag_t c_lflag;
 cc_t c_cc[NCCS];
@@ -562,7 +566,7 @@ void read_mud(ses)
     if(ses->logfile) {
       if (!OLD_LOG) {
       count=0;
-      for(n=0;n<=didget;n++) 
+      for(n=0;n<didget;n++)
          if (buffer[n]!='\r') { 
             temp[count]=buffer[n]; 
             count++;
@@ -732,7 +736,7 @@ void tintin_puts2(cptr, ses)
       sprintf(strng,"%c8%s\n\r%c7%c[%d;%df", E, cptr, E, E, input_row, input_col);
     else
       sprintf(strng,"%s\n\r", cptr);
-    write(1,strng, strlen(strng)+1);
+    write(1,strng, strlen(strng));
     display_col=1;
     if (redraw && term_echoing && !is_split)
       write(1, k_input, strlen(k_input));
@@ -764,7 +768,7 @@ void tintin_puts3(cptr, ses)
       cptr++;
       sprintf(strng,"%s\n\r", cptr);
     }
-    write(1,strng, strlen(strng)+1);
+    write(1,strng, strlen(strng));
     display_col=1;
   } 
   text_came=TRUE;  
@@ -832,7 +836,7 @@ void split_command(arg)
   input_col=1;  
   sprintf(fn, "%c[2J%c[1;%dr%c[%d;1f", E, E, display_row, E, split_line);
   write(1,fn, strlen(fn));
-  write(1,"-------------------------------------------------------------------------------", 80);
+  write(1,"--------------------------------------------------------------------------------", 80);
   sprintf(fn, "%c[%d;1f%c7", E, split_line-1, E);
   write(1,fn,strlen(fn));
   sprintf(fn, "%c[%d;1f", E, input_row);
