$OpenBSD: patch-main_c,v 1.1 2012/08/31 12:30:56 sthen Exp $

http://git.infradead.org/users/dwmw2/openconnect.git/commit/8e16a755388ffea541a4543e252ebbe297d2eee8

--- main.c.orig	Thu Jul 12 13:57:30 2012
+++ main.c	Wed Aug 29 21:06:56 2012
@@ -338,7 +338,7 @@ static int next_option(int argc, char **argv, char **c
  next:
 	if (!config_file) {
 		opt = getopt_long(argc, argv,
-				  "bC:c:e:Ddg:hi:k:lpP:Q:qSs:U:u:Vvx:",
+				  "bC:c:e:Ddg:hi:k:lp:P:Q:qSs:U:u:Vvx:",
 				  long_options, NULL);
 
 		*config_arg = optarg;
@@ -596,9 +596,13 @@ int main(int argc, char **argv)
 			}
 			break;
 		case 'p':
-			vpninfo->cert_password = strdup(config_arg);
+			if(config_arg)
+				vpninfo->cert_password = strdup(config_arg);
+			else {
+				fprintf(stderr, _("-p specified but no password given.\n"));
+			}
 			break;
-		case 'P': 
+		case 'P':
 			proxy = keep_config_arg();
 			autoproxy = 0;
 			break;
