$OpenBSD: patch-plugin_icedteanp_IcedTeaScriptablePluginObject_cc,v 1.1 2012/11/08 18:42:29 landry Exp $
http://icedtea.classpath.org/hg/release/icedtea-web-1.3/raw-rev/e7970f3da5fe
--- plugin/icedteanp/IcedTeaScriptablePluginObject.cc.orig	Mon Aug 27 21:36:42 2012
+++ plugin/icedteanp/IcedTeaScriptablePluginObject.cc	Thu Nov  8 19:38:14 2012
@@ -591,10 +591,7 @@ IcedTeaScriptableJavaObject::invoke(NPObject *npobj, N
 
     if (java_result->error_occurred)
     {
-        // error message must be allocated on heap
-        char* error_msg = (char*) malloc(java_result->error_msg->length()*sizeof(char));
-        strcpy(error_msg, java_result->error_msg->c_str());
-        browser_functions.setexception(npobj, error_msg);
+        browser_functions.setexception(npobj, java_result->error_msg->c_str());
         return false;
     }
 
@@ -853,11 +850,7 @@ IcedTeaScriptableJavaObject::construct(NPObject *npobj
         createJavaObjectFromVariant(instance, args[i], &id);
         if (id == "0")
         {
-            // error message must be allocated on heap
-            char* error_msg = (char*) malloc(1024*sizeof(char));
-            strcpy(error_msg, "Unable to create argument on Java side");
-
-            browser_functions.setexception(npobj, error_msg);
+            browser_functions.setexception(npobj, "Unable to create argument on Java side");
             return false;
         }
 
@@ -871,12 +864,7 @@ IcedTeaScriptableJavaObject::construct(NPObject *npobj
 
     if (java_result->error_occurred)
     {
-        // error message must be allocated on heap
-        int length = java_result->error_msg->length();
-        char* error_msg = (char*) malloc((length+1)*sizeof(char));
-        strcpy(error_msg, java_result->error_msg->c_str());
-
-        browser_functions.setexception(npobj, error_msg);
+        browser_functions.setexception(npobj, java_result->error_msg->c_str());
         return false;
     }
 
