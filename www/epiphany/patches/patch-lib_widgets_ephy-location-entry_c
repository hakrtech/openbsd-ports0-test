$OpenBSD: patch-lib_widgets_ephy-location-entry_c,v 1.1 2013/04/15 07:53:27 jasper Exp $

From 198f81ad99638085f2c430881e3f15db1c8d95df Mon Sep 17 00:00:00 2001
From: Carlos Garcia Campos <cgarcia@igalia.com>
Date: Thu, 28 Mar 2013 15:16:02 +0000
Subject: Do not schedule a DNS prefetch for invalid URIs or without a hostname

--- lib/widgets/ephy-location-entry.c.orig	Wed Mar  6 15:04:28 2013
+++ lib/widgets/ephy-location-entry.c	Mon Apr 15 09:44:20 2013
@@ -966,13 +966,20 @@ static void
 schedule_dns_prefetch (EphyLocationEntry *entry, guint interval, const gchar *url)
 {
 	PrefetchHelper *helper;
+	SoupURI *uri;
 
+	uri = soup_uri_new (url);
+	if (!uri || !uri->host) {
+		soup_uri_free (uri);
+		return;
+	}
+
 	if (entry->priv->dns_prefetch_handler)
 		g_source_remove (entry->priv->dns_prefetch_handler);
 
 	helper = g_slice_new0 (PrefetchHelper);
 	helper->entry = g_object_ref (entry);
-	helper->uri = soup_uri_new (url);
+	helper->uri = uri;
 
 	entry->priv->dns_prefetch_handler =
 		g_timeout_add_full (G_PRIORITY_DEFAULT, interval,
