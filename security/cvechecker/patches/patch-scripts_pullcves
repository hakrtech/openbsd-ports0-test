$OpenBSD: patch-scripts_pullcves,v 1.1 2016/01/25 15:52:36 jasper Exp $

From b9e76bda4528fea3f15d4bf86d527e4353b90aea Mon Sep 17 00:00:00 2001
From: Sven Vermeulen <sven.vermeulen@siphos.be>
Date: Fri, 6 Nov 2015 18:21:19 +0100
Subject: [PATCH] Downloading compressed XML and decompress; Since Oct 18 uncompressed downloads are no longer supported

--- scripts/pullcves.orig	Tue Sep 17 12:48:03 2013
+++ scripts/pullcves	Mon Jan 25 15:30:06 2016
@@ -61,7 +61,8 @@ do
   if [ ! -f ${CVECACHE}/nvdcve-2.0-20${YEAR}.xml ];
   then
     printf "Downloading nvdcve-2.0-20${YEAR}.xml... ";
-    ${WGETCMD} -q -O ${CVECACHE}/nvdcve-2.0-20${YEAR}.xml http://static.nvd.nist.gov/feeds/xml/cve/nvdcve-2.0-20${YEAR}.xml;
+    ${WGETCMD} -q -O ${CVECACHE}/nvdcve-2.0-20${YEAR}.xml.gz http://static.nvd.nist.gov/feeds/xml/cve/nvdcve-2.0-20${YEAR}.xml.gz;
+    gunzip -c ${CVECACHE}/nvdcve-2.0-20${YEAR}.xml.gz > ${CVECACHE}/nvdcve-2.0-20${YEAR}.xml && rm ${CVECACHE}/nvdcve-2.0-20${YEAR}.xml.gz;
     printf "ok\nConverting nvdcve-2.0-20${YEAR}.xml to CSV... ";
     xsltproc ${DATADIR}/nvdcve2simple.xsl ${CVECACHE}/nvdcve-2.0-20${YEAR}.xml > ${CVECACHE}/nvdcve-2.0-20${YEAR}.csv;
     printf "ok\nLoading in nvdcve-2.0-20${YEAR}.csv in cvechecker.\n";
@@ -77,7 +78,8 @@ else
   CKSUM=$(cksum nvdcve-2.0-modified.xml 2>/dev/null);
 fi
 printf "Downloading nvdcve-2.0-modified.xml... ";
-${WGETCMD} -q -N http://static.nvd.nist.gov/feeds/xml/cve/nvdcve-2.0-modified.xml;
+${WGETCMD} -q -N http://static.nvd.nist.gov/feeds/xml/cve/nvdcve-2.0-Modified.xml.gz;
+gunzip -c nvdcve-2.0-Modified.xml.gz > nvdcve-2.0-Modified.xml && rm nvdcve-2.0-Modified.xml.gz;
 CKSUM2=$(cksum nvdcve-2.0-modified.xml 2>/dev/null);
 if [ "${CKSUM2}" != "${CKSUM}" ] || [ -f nvdcve-2.0-modified.xml.1 ];
 then
